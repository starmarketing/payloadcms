"use strict";(self.webpackChunkpayload_starter_typescript=self.webpackChunkpayload_starter_typescript||[]).push([[995],{8398:(e,t,l)=>{l.d(t,{Z:()=>s});var a=l(7294),n=l(3902);l(1251);const i="render-title",s=e=>{const{useAsTitle:t,title:l,data:s,fallback:r="[untitled]"}=e,o=(0,n.Z)(t);let c=s&&s[t];c||(c=o),c||(c=null==s?void 0:s.id),c||(c=r),c=l||c;const u=c===(null==s?void 0:s.id),d=[i,u&&`${i}--id-as-title`].filter(Boolean).join(" ");return a.createElement("span",{className:d},u&&a.createElement(a.Fragment,null,"ID:  "),c)}},3588:(e,t,l)=>{l.d(t,{Z:()=>Z});var a=l(7294),n=l(9249),i=l(9243),s=l(8571),r=l(6067),o=l(5212),c=l(4479),u=l(4007),d=l(4012),m=l(4586),p=l(8170),E=l(953),v=l(9410),f=l(5193),y=l(1851),g=l(9599);l(5891);const $=e=>{const{setKey:t,highlightField:l}=e,{toggle:i}=(0,y.useModal)(),s="generate-confirmation";return a.createElement(a.Fragment,null,a.createElement(c.Z,{size:"small",buttonStyle:"secondary",onClick:()=>{i(s)}},"Generate new API key"),a.createElement(y.Modal,{slug:s,className:"generate-confirmation"},a.createElement(g.Z,null,a.createElement("h1",null,"Confirm Generation"),a.createElement("p",null,"Generating a new API key will"," ",a.createElement("strong",null,"invalidate")," ","the previous key."," ","Are you sure you wish to continue?"),a.createElement(c.Z,{buttonStyle:"secondary",type:"button",onClick:()=>{i(s)}},"Cancel"),a.createElement(c.Z,{onClick:()=>{t(),i(s),n.Am.success("New API Key Generated.",{autoClose:3e3}),l(!0)}},"Generate"))))},h="apiKey",b=e=>(0,f.text)(e,{minLength:24,maxLength:48}),_=()=>{const[e,t]=(0,a.useState)(null),[l,n]=(0,a.useState)(!1),{getField:i}=(0,d.ey)(),s=i(h),r=null==s?void 0:s.value,o=(0,a.useMemo)((()=>a.createElement("div",{className:"api-key__label"},a.createElement("span",null,"API Key"),a.createElement(v.Z,{value:r}))),[r]),c=(0,p.Z)({path:"apiKey",validate:b}),{value:u,setValue:f}=c;(0,a.useEffect)((()=>{t((0,m.Z)())}),[]),(0,a.useEffect)((()=>{r||f(e)}),[r,f,e]),(0,a.useEffect)((()=>{l&&setTimeout((()=>{n(!1)}),1e4)}),[l]);const y=["field-type","api-key","read-only"].filter(Boolean).join(" ");return a.createElement(a.Fragment,null,a.createElement("div",{className:y},a.createElement(E.Z,{htmlFor:h,label:o}),a.createElement("input",{value:u||"",className:l?"highlight":void 0,disabled:!0,type:"text",id:"apiKey",name:"apiKey"})),a.createElement($,{setKey:()=>f((0,m.Z)()),highlightField:()=>{l&&n(!1),setTimeout((()=>{n(!0)}),1)}}))};l(2554);const C="auth-fields",Z=e=>{const{useAPIKey:t,requirePassword:l,verify:m,collection:{slug:p},email:E,operation:v}=e,[f,y]=(0,a.useState)(l),{getField:g}=(0,d.ey)(),$=(0,d.$f)(),h=g("enableAPIKey");(0,a.useEffect)((()=>{$||y(!1)}),[$]);const{serverURL:b,routes:{api:Z}}=(0,i.useConfig)(),k=(0,a.useCallback)((async()=>{const e=`${b}${Z}/${p}/unlock`;200===(await fetch(e,{headers:{"Content-Type":"application/json"},body:JSON.stringify({email:E}),method:"post"})).status?n.Am.success("Successfully unlocked",{autoClose:3e3}):n.Am.error("Successfully unlocked")}),[b,Z,p,E]);return a.createElement("div",{className:C},a.createElement(s.Z,{required:!0,name:"email",label:"Email",admin:{autoComplete:"email"}}),(f||l)&&a.createElement("div",{className:"auth-fields__changing-password"},a.createElement(r.Z,{autoComplete:"off",required:!0,name:"password",label:"New Password"}),a.createElement(u.Z,null),!l&&a.createElement(c.Z,{size:"small",buttonStyle:"secondary",onClick:()=>y(!1)},"Cancel")),!f&&!l&&a.createElement(c.Z,{size:"small",buttonStyle:"secondary",onClick:()=>y(!0)},"Change Password"),"update"===v&&a.createElement(c.Z,{size:"small",buttonStyle:"secondary",onClick:()=>k()},"Force Unlock"),t&&a.createElement("div",{className:"auth-fields__api-key"},a.createElement(o.Z,{label:"Enable API Key",name:"enableAPIKey"}),(null==h?void 0:h.value)&&a.createElement(_,null)),m&&a.createElement(o.Z,{label:"Verified",name:"_verified"}))}},5995:(e,t,l)=>{l.r(t),l.d(t,{default:()=>B});var a=l(7294),n=l(5977),i=l(9243),s=l(5091),r=l(7489),o=l(2143),c=l(5074),u=l(3727),d=l(9546),m=l(8584),p=l(8572),E=l(829),v=l(4983),f=l(6268),y=l(1439),g=l(9410),$=l(4479),h=l(4012);l(9280);const b=({slug:e})=>{const{push:t}=(0,n.k6)(),{getData:l}=(0,h.cI)(),{routes:{admin:s}}=(0,i.useConfig)(),r=(0,a.useCallback)((()=>{const a=l();t({pathname:`${s}/collections/${e}/create`,state:{data:a}})}),[t,l,e,s]);return a.createElement($.Z,{buttonStyle:"none",className:"duplicate",onClick:r},"Duplicate")};var _=l(9249),C=l(1851),Z=l(9599),k=l(3902),w=l(1278);l(6993);const N="delete-document",S=e=>{const{title:t,id:l,collection:{admin:{useAsTitle:s},slug:r,labels:{singular:o}={}}={}}=e,{serverURL:c,routes:{api:u,admin:d}}=(0,i.useConfig)(),{setModified:m}=(0,h.cI)(),[p,E]=(0,a.useState)(!1),{closeAll:v,toggle:f}=(0,C.useModal)(),y=(0,n.k6)(),g=(0,k.Z)(s)||l,b=t||g,S=`delete-${l}`,A=(0,a.useCallback)((()=>{_.Am.error(`There was an error while deleting ${g}. Please check your connection and try again.`)}),[g]),P=(0,a.useCallback)((()=>{E(!0),m(!1),w.E.delete(`${c}${u}/${r}/${l}`,{headers:{"Content-Type":"application/json"}}).then((async e=>{try{const t=await e.json();return e.status<400?(v(),y.push({pathname:`${d}/collections/${r}`,state:{status:{message:`${o} "${g}" successfully deleted.`}}})):(v(),t.errors&&_.Am.error(t.errors),A(),!1)}catch(e){return A()}}))}),[A,v,y,l,o,r,g,d,u,c,m]);return l?a.createElement(a.Fragment,null,a.createElement("button",{type:"button",className:"delete-document__toggle",onClick:e=>{e.preventDefault(),f(S)}},"Delete"),a.createElement(C.Modal,{slug:S,className:N},a.createElement(Z.Z,null,a.createElement("h1",null,"Confirm deletion"),a.createElement("p",null,"You are about to delete the"," ",o," ",'"',a.createElement("strong",null,b),'". Are you sure?'),a.createElement($.Z,{buttonStyle:"secondary",type:"button",onClick:p?void 0:()=>f(S)},"Cancel"),a.createElement($.Z,{onClick:p?void 0:P},p?"Deleting...":"Confirm")))):null};var A=l(8380),P=l(2570),F=l(8398),I=l(854),L=l(3588),K=l(6054);l(7841);const T="collection-edit",D=e=>{var t,l;const{params:{id:s}={}}=(0,n.$B)(),{admin:{dateFormat:r},routes:{admin:o}}=(0,i.useConfig)(),{collection:c,isEditing:$,data:h,onSave:_,permissions:C,isLoading:Z,initialState:k,apiURL:w,action:N,hasSavePermission:D}=e,{slug:U,fields:R,admin:{useAsTitle:M,disableDuplicate:j,preview:V},timestamps:B,auth:G,upload:q}=c,z=[T,$&&`${T}--is-editing`].filter(Boolean).join(" "),x=$?"update":"create";return a.createElement("div",{className:z},a.createElement(p.Z,{className:`${T}__form`,method:s?"put":"post",action:N,onSuccess:_,disabled:!D,initialState:k},a.createElement("div",{className:`${T}__main`},a.createElement(A.Z,{title:`${$?"Editing":"Creating"} - ${c.labels.singular}`,description:`${$?"Editing":"Creating"} - ${c.labels.singular}`,keywords:`${c.labels.singular}, Payload, CMS`}),a.createElement(m.Z,null),a.createElement(I.Z,null),a.createElement("div",{className:`${T}__edit`},Z&&a.createElement(E.Z,null),!Z&&a.createElement(a.Fragment,null,a.createElement("header",{className:`${T}__header`},a.createElement("h1",null,a.createElement(F.Z,{data:h,useAsTitle:M,fallback:"[Untitled]"}))),G&&a.createElement(L.Z,{useAPIKey:G.useAPIKey,requirePassword:!$,verify:G.verify,collection:c,email:null==h?void 0:h.email,operation:x}),q&&a.createElement(K.Z,{data:h,collection:c}),a.createElement(y.Z,{operation:x,readOnly:!D,permissions:C.fields,filter:e=>{var t,l;return!(null===(t=null==e?void 0:e.admin)||void 0===t?void 0:t.position)||"sidebar"!==(null===(l=null==e?void 0:e.admin)||void 0===l?void 0:l.position)},fieldTypes:P.Z,fieldSchema:R})))),a.createElement("div",{className:`${T}__sidebar-wrap`},a.createElement("div",{className:`${T}__sidebar`},a.createElement("div",{className:`${T}__sidebar-sticky-wrap`},$?a.createElement("ul",{className:`${T}__collection-actions`},(null===(t=null==C?void 0:C.create)||void 0===t?void 0:t.permission)&&a.createElement(a.Fragment,null,a.createElement("li",null,a.createElement(u.Link,{to:`${o}/collections/${U}/create`},"Create New")),!j&&a.createElement("li",null,a.createElement(b,{slug:U}))),(null===(l=null==C?void 0:C.delete)||void 0===l?void 0:l.permission)&&a.createElement("li",null,a.createElement(S,{collection:c,id:s}))):void 0,a.createElement("div",{className:`${T}__document-actions${V&&$?` ${T}__document-actions--with-preview`:""}`},$&&a.createElement(v.Z,{generatePreviewURL:V,data:h}),D&&a.createElement(f.Z,null,"Save")),!Z&&a.createElement(a.Fragment,null,a.createElement("div",{className:`${T}__sidebar-fields`},a.createElement(y.Z,{operation:$?"update":"create",readOnly:!D,permissions:C.fields,filter:e=>{var t;return"sidebar"===(null===(t=null==e?void 0:e.admin)||void 0===t?void 0:t.position)},fieldTypes:P.Z,fieldSchema:R})),$&&a.createElement("ul",{className:`${T}__meta`},a.createElement("li",{className:`${T}__api-url`},a.createElement("span",{className:`${T}__label`},"API URL"," ",a.createElement(g.Z,{value:w})),a.createElement("a",{href:w,target:"_blank",rel:"noopener noreferrer"},w)),a.createElement("li",null,a.createElement("div",{className:`${T}__label`},"ID"),a.createElement("div",null,s)),B&&a.createElement(a.Fragment,null,h.updatedAt&&a.createElement("li",null,a.createElement("div",{className:`${T}__label`},"Last Modified"),a.createElement("div",null,(0,d.default)(new Date(h.updatedAt),r))),h.createdAt&&a.createElement("li",null,a.createElement("div",{className:`${T}__label`},"Created"),a.createElement("div",null,(0,d.default)(new Date(h.createdAt),r)))))))))))};var U=l(3780);const R=(e,t)=>t?e.fields.filter((e=>(0,U.fieldAffectsData)(e)&&"id"!==e.name||!0)):e.fields;var M=l(3864),j=l(161),V=l(684);const B=e=>{var t,l,u,d;const{collection:m,isEditing:p}=e,{slug:E,labels:{plural:v},admin:{useAsTitle:f,components:{views:{Edit:y}={}}={}}={}}=m,[g]=(0,a.useState)((()=>R(m,p))),$=(0,V.bU)(),{serverURL:h,routes:{admin:b,api:_}}=(0,i.useConfig)(),{params:{id:C}={}}=(0,n.$B)(),{state:Z}=(0,n.TH)(),k=(0,n.k6)(),{setStepNav:w}=(0,s.FP)(),[N,S]=(0,a.useState)({}),{permissions:A}=(0,i.useAuth)(),[{data:P,isLoading:F,isError:I}]=(0,r.Z)(p?`${h}${_}/${E}/${C}`:null,{initialParams:{"fallback-locale":"null",depth:0}}),L=(null===(t=Z)||void 0===t?void 0:t.data)||P;if((0,a.useEffect)((()=>{const e=[{url:`${b}/collections/${E}`,label:v}];p?e.push({label:L?L[f||"id"]:""}):e.push({label:"Create New"}),w(e)}),[w,p,v,L,E,f,b]),(0,a.useEffect)((()=>{(async()=>{const e=await(0,M.Z)(g,L);S(e)})()}),[L,g]),I)return a.createElement(n.l_,{to:`${b}/not-found`});const K=null===(l=null==A?void 0:A.collections)||void 0===l?void 0:l[E],T=`${h}${_}/${E}/${C}`,U=`${h}${_}/${E}${p?`/${C}`:""}?locale=${$}&depth=0&fallback-locale=null`,B=p&&(null===(u=null==K?void 0:K.update)||void 0===u?void 0:u.permission)||!p&&(null===(d=null==K?void 0:K.create)||void 0===d?void 0:d.permission);return a.createElement(c.a4,{id:C,slug:m.slug,type:"collection"},a.createElement(j.S,{allow:!0},a.createElement(o.Z,{DefaultComponent:D,CustomComponent:y,componentProps:{isLoading:F,data:L,collection:{...m,fields:g},permissions:K,isEditing:p,onSave:async e=>{var t;if(p){const t=await(0,M.Z)(g,e.doc);S(t),k.push({state:{data:e.doc}})}else k.push(`${b}/collections/${m.slug}/${null===(t=null==e?void 0:e.doc)||void 0===t?void 0:t.id}`)},initialState:N,hasSavePermission:B,apiURL:T,action:U}})))}},3902:(e,t,l)=>{l.d(t,{Z:()=>n});var a=l(4012);const n=e=>{const{getField:t}=(0,a.ey)(),l=t(e);return null==l?void 0:l.value}},4586:(e,t,l)=>{var a;l.d(t,{Z:()=>d});var n=new Uint8Array(16);function i(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(n)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const r=function(e){return"string"==typeof e&&s.test(e)};for(var o=[],c=0;c<256;++c)o.push((c+256).toString(16).substr(1));const u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase();if(!r(l))throw TypeError("Stringified UUID is invalid");return l};const d=function(e,t,l){var a=(e=e||{}).random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){l=l||0;for(var n=0;n<16;++n)t[l+n]=a[n];return t}return u(a)}}}]);