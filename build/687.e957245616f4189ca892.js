"use strict";(self.webpackChunkpayload_starter_typescript=self.webpackChunkpayload_starter_typescript||[]).push([[687],{8398:(e,t,l)=>{l.d(t,{Z:()=>r});var a=l(7294),n=l(3902);l(1251);const i="render-title",r=e=>{const{useAsTitle:t,title:l,data:r,fallback:s="[untitled]"}=e,o=(0,n.Z)(t);let c=r&&r[t];c||(c=o),c||(c=null==r?void 0:r.id),c||(c=s),c=l||c;const u=c===(null==r?void 0:r.id),d=[i,u&&`${i}--id-as-title`].filter(Boolean).join(" ");return a.createElement("span",{className:d},u&&a.createElement(a.Fragment,null,"ID:  "),c)}},5687:(e,t,l)=>{l.r(t),l.d(t,{default:()=>S});var a=l(7294),n=l(5977),i=l(9243),r=l(5091),s=l(7489),o=l(684),c=l(5074),u=l(3727),d=l(9546),m=l(8584),p=l(8572),v=l(4983),E=l(6268),f=l(1439),y=l(9410),g=l(2570),h=l(8398),_=l(854),b=l(8380),Z=l(3588),$=l(829);l(86);const w="account",C=e=>{var t;const{collection:l,data:n,permissions:r,hasSavePermission:s,apiURL:o,initialState:c,isLoading:C,action:A}=e,{slug:N,fields:k,admin:{useAsTitle:S,preview:P},timestamps:F,auth:I}=l,{admin:{dateFormat:K},routes:{admin:L}}=(0,i.useConfig)(),U=[w].filter(Boolean).join(" ");return a.createElement("div",{className:U},a.createElement(p.Z,{className:`${w}__form`,method:"put",action:A,initialState:c,disabled:!s},a.createElement("div",{className:`${w}__main`},a.createElement(b.Z,{title:"Account",description:"Account of current user",keywords:"Account, Dashboard, Payload, CMS"}),a.createElement(m.Z,null),a.createElement(_.Z,null),a.createElement("div",{className:`${w}__edit`},C&&a.createElement($.Z,null),!C&&a.createElement(a.Fragment,null,a.createElement("header",{className:`${w}__header`},a.createElement("h1",null,a.createElement(h.Z,{data:n,useAsTitle:S,fallback:"[Untitled]"}))),a.createElement(Z.Z,{useAPIKey:I.useAPIKey,collection:l,email:null==n?void 0:n.email,operation:"update"}),a.createElement(f.Z,{operation:"update",permissions:r.fields,readOnly:!s,filter:e=>{var t;return"sidebar"!==(null===(t=null==e?void 0:e.admin)||void 0===t?void 0:t.position)},fieldTypes:g.Z,fieldSchema:k})))),a.createElement("div",{className:`${w}__sidebar-wrap`},a.createElement("div",{className:`${w}__sidebar`},a.createElement("div",{className:`${w}__sidebar-sticky-wrap`},a.createElement("ul",{className:`${w}__collection-actions`},(null===(t=null==r?void 0:r.create)||void 0===t?void 0:t.permission)&&a.createElement(a.Fragment,null,a.createElement("li",null,a.createElement(u.Link,{to:`${L}/collections/${N}/create`},"Create New")))),a.createElement("div",{className:`${w}__document-actions${P?` ${w}__document-actions--with-preview`:""}`},a.createElement(v.Z,{generatePreviewURL:P,data:n}),s&&a.createElement(E.Z,null,"Save")),a.createElement("div",{className:`${w}__sidebar-fields`},a.createElement(f.Z,{operation:"update",permissions:r.fields,readOnly:!s,filter:e=>{var t;return"sidebar"===(null===(t=null==e?void 0:e.admin)||void 0===t?void 0:t.position)},fieldTypes:g.Z,fieldSchema:k})),a.createElement("ul",{className:`${w}__meta`},a.createElement("li",{className:`${w}__api-url`},a.createElement("span",{className:`${w}__label`},"API URL"," ",a.createElement(y.Z,{value:o})),a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},o)),a.createElement("li",null,a.createElement("div",{className:`${w}__label`},"ID"),a.createElement("div",null,null==n?void 0:n.id)),F&&a.createElement(a.Fragment,null,n.updatedAt&&a.createElement("li",null,a.createElement("div",{className:`${w}__label`},"Last Modified"),a.createElement("div",null,(0,d.default)(new Date(n.updatedAt),K))),n.createdAt&&a.createElement("li",null,a.createElement("div",{className:`${w}__label`},"Created"),a.createElement("div",null,(0,d.default)(new Date(n.createdAt),K))))))))))};var A=l(3864),N=l(2143),k=l(161);const S=()=>{var e,t;const{state:l}=(0,n.TH)(),u=(0,o.bU)(),{setStepNav:d}=(0,r.FP)(),{user:m,permissions:p}=(0,i.useAuth)(),[v,E]=(0,a.useState)({}),{serverURL:f,routes:{api:y},collections:g,admin:{user:h,components:{views:{Account:_}={Account:void 0}}={}}={user:"users"}}=(0,i.useConfig)(),b=g.find((e=>e.slug===m.collection)),{fields:Z}=b,$=null===(e=null==p?void 0:p.collections)||void 0===e?void 0:e[h],[{data:w,isLoading:S}]=(0,s.Z)(`${f}${y}/${null==b?void 0:b.slug}/${null==m?void 0:m.id}?depth=0`,{initialParams:{"fallback-locale":"null"}}),P=null===(t=null==$?void 0:$.update)||void 0===t?void 0:t.permission,F=(null==l?void 0:l.data)||w,I=`${f}${y}/${m.collection}/${null==w?void 0:w.id}`,K=`${f}${y}/${m.collection}/${null==w?void 0:w.id}?locale=${u}&depth=0`;return(0,a.useEffect)((()=>{d([{label:"Account"}])}),[d]),(0,a.useEffect)((()=>{(async()=>{const e=await(0,A.Z)(Z,F);E(e)})()}),[F,Z]),a.createElement(c.a4,{type:"collection",slug:null==b?void 0:b.slug,id:null==m?void 0:m.id},a.createElement(k.S,{allow:!0},a.createElement(N.Z,{DefaultComponent:C,CustomComponent:_,componentProps:{action:K,data:w,collection:b,permissions:$,hasSavePermission:P,initialState:v,apiURL:I,isLoading:S}})))}},3588:(e,t,l)=>{l.d(t,{Z:()=>w});var a=l(7294),n=l(9249),i=l(9243),r=l(8571),s=l(6067),o=l(5212),c=l(4479),u=l(4007),d=l(4012),m=l(4586),p=l(8170),v=l(953),E=l(9410),f=l(5193),y=l(1851),g=l(9599);l(5891);const h=e=>{const{setKey:t,highlightField:l}=e,{toggle:i}=(0,y.useModal)(),r="generate-confirmation";return a.createElement(a.Fragment,null,a.createElement(c.Z,{size:"small",buttonStyle:"secondary",onClick:()=>{i(r)}},"Generate new API key"),a.createElement(y.Modal,{slug:r,className:"generate-confirmation"},a.createElement(g.Z,null,a.createElement("h1",null,"Confirm Generation"),a.createElement("p",null,"Generating a new API key will"," ",a.createElement("strong",null,"invalidate")," ","the previous key."," ","Are you sure you wish to continue?"),a.createElement(c.Z,{buttonStyle:"secondary",type:"button",onClick:()=>{i(r)}},"Cancel"),a.createElement(c.Z,{onClick:()=>{t(),i(r),n.Am.success("New API Key Generated.",{autoClose:3e3}),l(!0)}},"Generate"))))},_="apiKey",b=e=>(0,f.text)(e,{minLength:24,maxLength:48}),Z=()=>{const[e,t]=(0,a.useState)(null),[l,n]=(0,a.useState)(!1),{getField:i}=(0,d.ey)(),r=i(_),s=null==r?void 0:r.value,o=(0,a.useMemo)((()=>a.createElement("div",{className:"api-key__label"},a.createElement("span",null,"API Key"),a.createElement(E.Z,{value:s}))),[s]),c=(0,p.Z)({path:"apiKey",validate:b}),{value:u,setValue:f}=c;(0,a.useEffect)((()=>{t((0,m.Z)())}),[]),(0,a.useEffect)((()=>{s||f(e)}),[s,f,e]),(0,a.useEffect)((()=>{l&&setTimeout((()=>{n(!1)}),1e4)}),[l]);const y=["field-type","api-key","read-only"].filter(Boolean).join(" ");return a.createElement(a.Fragment,null,a.createElement("div",{className:y},a.createElement(v.Z,{htmlFor:_,label:o}),a.createElement("input",{value:u||"",className:l?"highlight":void 0,disabled:!0,type:"text",id:"apiKey",name:"apiKey"})),a.createElement(h,{setKey:()=>f((0,m.Z)()),highlightField:()=>{l&&n(!1),setTimeout((()=>{n(!0)}),1)}}))};l(2554);const $="auth-fields",w=e=>{const{useAPIKey:t,requirePassword:l,verify:m,collection:{slug:p},email:v,operation:E}=e,[f,y]=(0,a.useState)(l),{getField:g}=(0,d.ey)(),h=(0,d.$f)(),_=g("enableAPIKey");(0,a.useEffect)((()=>{h||y(!1)}),[h]);const{serverURL:b,routes:{api:w}}=(0,i.useConfig)(),C=(0,a.useCallback)((async()=>{const e=`${b}${w}/${p}/unlock`;200===(await fetch(e,{headers:{"Content-Type":"application/json"},body:JSON.stringify({email:v}),method:"post"})).status?n.Am.success("Successfully unlocked",{autoClose:3e3}):n.Am.error("Successfully unlocked")}),[b,w,p,v]);return a.createElement("div",{className:$},a.createElement(r.Z,{required:!0,name:"email",label:"Email",admin:{autoComplete:"email"}}),(f||l)&&a.createElement("div",{className:"auth-fields__changing-password"},a.createElement(s.Z,{autoComplete:"off",required:!0,name:"password",label:"New Password"}),a.createElement(u.Z,null),!l&&a.createElement(c.Z,{size:"small",buttonStyle:"secondary",onClick:()=>y(!1)},"Cancel")),!f&&!l&&a.createElement(c.Z,{size:"small",buttonStyle:"secondary",onClick:()=>y(!0)},"Change Password"),"update"===E&&a.createElement(c.Z,{size:"small",buttonStyle:"secondary",onClick:()=>C()},"Force Unlock"),t&&a.createElement("div",{className:"auth-fields__api-key"},a.createElement(o.Z,{label:"Enable API Key",name:"enableAPIKey"}),(null==_?void 0:_.value)&&a.createElement(Z,null)),m&&a.createElement(o.Z,{label:"Verified",name:"_verified"}))}},3902:(e,t,l)=>{l.d(t,{Z:()=>n});var a=l(4012);const n=e=>{const{getField:t}=(0,a.ey)(),l=t(e);return null==l?void 0:l.value}},4586:(e,t,l)=>{var a;l.d(t,{Z:()=>d});var n=new Uint8Array(16);function i(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(n)}const r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const s=function(e){return"string"==typeof e&&r.test(e)};for(var o=[],c=0;c<256;++c)o.push((c+256).toString(16).substr(1));const u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase();if(!s(l))throw TypeError("Stringified UUID is invalid");return l};const d=function(e,t,l){var a=(e=e||{}).random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){l=l||0;for(var n=0;n<16;++n)t[l+n]=a[n];return t}return u(a)}}}]);